using System;
using System.Linq;
namespace ConsoleApp19
{
    class Program
    {
        static int DifficultyChoice()
        {
            bool isdifvalid = false;// makes sure the difficulty inputted is a valid option

            char dif = 'z';//goverens the difficuly
            int lottolength = 0;// lotto length is the amount of numbers chosen by both the RNG and the user, 9 on easy, 6 on normal, 3 on hard
            while (isdifvalid == false)//start of difficulty selection
            {
                Console.WriteLine("Please select a difficulty. (e for easy, n for normal, h for hard)");
                isdifvalid = char.TryParse(Console.ReadLine(), out dif);

                switch (dif)
                {
                    case ('e'):
                    case ('E'):
                        lottolength = 9;
                        Console.ForegroundColor = ConsoleColor.Green;
                        Console.WriteLine("You have selected easy difficulty.");
                        Console.ResetColor();
                        isdifvalid = true;
                        break;
                    case ('n'):
                    case ('N'):
                        lottolength = 6;
                        Console.ForegroundColor = ConsoleColor.Blue;
                        Console.WriteLine("You have selected normal difficulty.");
                        Console.ResetColor();
                        isdifvalid = true;
                        break;
                    case ('h'):
                    case ('H'):
                        lottolength = 3;
                        Console.ForegroundColor = ConsoleColor.DarkRed;
                        Console.WriteLine("You have selected hard difficulty.");
                        Console.ResetColor();
                        isdifvalid = true;
                        break;
                    default:
                        Console.ForegroundColor = ConsoleColor.Red;
                        Console.WriteLine("Invalid difficulty choice.");
                        Console.ResetColor();
                        isdifvalid = false;
                        break;
                }
            }
            return lottolength;
        }
        static int[] GenerateRandomNumbers(int lottolength, Random rnd)
        {
            int i = 0;
            int[] lottonums = new int[lottolength];// the array containing the randomly generated numbers
            int buf = 0;
            while (i < lottolength)
            {
                buf = rnd.Next(1, 47);
                if (!(lottonums.Contains(buf)))
                {
                    lottonums[i] = buf;
                    i++;
                }
            }
            return lottonums;
        }
        static int[] UsersSelectsNumbers(int lottolength)
        {
            bool isvalid = false;//makes sure the inputted numbers by the user are valid
            int[] usernums = new int[lottolength];// the array containing the user's chosen numbers
            int i = 0, buf = 0;//buffer;
            while (i < lottolength)//start of user inputting numbers
            {
                isvalid = false;

                Console.WriteLine("Please input number {0} of {1}", i + 1,lottolength);
                isvalid = int.TryParse(Console.ReadLine(), out buf);
                if ((isvalid) && !(buf < 1) && !(buf > 46))
                {
                    if (!usernums.Contains(buf))
                    {
                        usernums[i] = buf;
                        i++;
                    }
                    else
                    {
                        Console.ForegroundColor = ConsoleColor.Red;
                        Console.WriteLine("You already inputted that number, please enter a number you haven't inputted before");
                        Console.ResetColor();
                    }
                }
                else
                {
                    Console.ForegroundColor = ConsoleColor.Red;
                    Console.WriteLine("Invalid input, please enter an integer between 1 and 46");
                    Console.ResetColor();
                }
            }
            return usernums;
        }
        static int CheckForHits(int lottolength, int[] lottonums, int[] usernums)
        {
            int i = 0, j = 0,
                hits = 0;//how many numbers the user got rightcolor//decides color

            while (i < lottolength)//checks how many numbers the user got right
            {
                j = 0;
                while (j < lottolength)
                {
                    if (lottonums[i] == usernums[j])
                    {
                        hits++;
                    }
                    j++;
                }
                i++;
            }
            return hits;
        }//compares the numbers the user selected to the numbers the computer generated to check for correct guesses
        static void DisplayResult(int hits, Random rnd)
        {
            //ConsoleColor ar[] =[ConsoleColor.Blue, ConsoleColor.Cyan, ConsoleColor.Red, ConsoleColor.DarkBlue, ConsoleColor.DarkCyan, ConsoleColor.Magenta, ConsoleColor.Yellow, ConsoleColor.DarkMagenta, ConsoleColor.DarkRed, ConsoleColor.DarkYellow];
            String[] colorNames = ConsoleColor.GetNames(typeof(ConsoleColor));
            int numColors = colorNames.Length;
            int timer = 0;
            if (hits == 1)
            {
                Console.ForegroundColor = ConsoleColor.Blue;
                Console.WriteLine("GRATZ! YOU GOT A HIT");
                Console.ResetColor();
            }
            else if (hits > 0)
            {
                while (timer < 15000)//start of the number flashing color
                {
                    string colorName = colorNames[rnd.Next(numColors)];
                    ConsoleColor color = (ConsoleColor)Enum.Parse(typeof(ConsoleColor), colorName);
                    Console.ForegroundColor = color;

                    Console.SetCursorPosition(Console.CursorLeft, Console.CursorTop - 1);
                    timer++;
                    Console.WriteLine("GRATZ! YOU GOT {0} HITS!", hits);
                }
            }
            else
            {
                Console.ForegroundColor = ConsoleColor.Red;
                Console.WriteLine("You got no hits :(");
            }
            Console.ResetColor();
        }
        static bool ShouldRepeat()
        {
            char repeatcheck;
            Console.WriteLine("");
            Console.WriteLine("another round?(input y to accept)");
            bool repeat = char.TryParse(Console.ReadLine(), out repeatcheck);
            if (repeatcheck == 'y' || repeatcheck == 'Y')
            {
                repeat = false;
            }
            else
            {
                repeat = true;
            }
            return repeat;
        }//asks the if he wants to play again
        static void DisplayGeneratedNumbers(int lottolength,int[] lottonums)
        {
            Console.WriteLine("the numbers genereated were:");// display the randomly generated numbers
            int i = 0;
            while (i < lottolength)
            {
                Console.Write("{0},", lottonums[i]);
                i++;
            }
        }
        static void Main(string[] args)
        {
            bool repeat = false;
            while (!repeat)
            {
                Random rnd = new Random();
                int lottolength = DifficultyChoice();
                int[] lottonums = GenerateRandomNumbers(lottolength, rnd);
                int[] usernums = UsersSelectsNumbers(lottolength);
                int hits = CheckForHits(lottolength, lottonums, usernums);
                DisplayResult(hits, rnd);
                DisplayGeneratedNumbers(lottolength, lottonums);
                repeat = ShouldRepeat();
            }
        }
    }
}
